package main

import (
	"fmt"
	"github.com/DmitriiTrifonov/gost-ciphers/kuznechik/ecb"
	)

func main() {
	var plaintext = [0x10]uint8 {
		0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x00,
		0xFF, 0xee, 0xdd, 0xcc, 0xbb, 0xaa, 0x99, 0x88,
	}

	fmt.Print("\nPlaintext: ")
	for i := 0; i < len(plaintext); i++ {
		fmt.Printf("0x%X, ",plaintext[i])
	}

	var cipherText = [0x10]uint8 {
		0x7F, 0x67, 0x9D, 0x90, 0xBE, 0xBC, 0x24, 0x30,
		0x5A, 0x46, 0x8D, 0x42, 0xB9, 0xD4, 0xED, 0xCD,
	}

	fmt.Print("\nCiphertext: ")
	for i := 0; i < len(cipherText); i++ {
		fmt.Printf("0x%X, ", cipherText[i])
	}

	var key = [0x20]uint8 {
		0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 	// 00..07
		0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 	// 08..0F
		0xFE, 0xDC, 0xBA, 0x98, 0x76, 0x54, 0x32, 0x10, 	// 10..17
		0x01, 0x23, 0x45, 0x67, 0x89, 0xAB, 0xCD, 0xEF, 	// 18..1F
	}

	ecb.SetKey(&key)

	var encrypted = ecb.Encrypt(plaintext)
	fmt.Print("\nCipher Encryption Result: ")
	for i := 0; i < len(encrypted); i++ {
		fmt.Printf("0x%X, ",encrypted[i])
	}

	var decrypted = ecb.Decrypt(cipherText)

	fmt.Print("\nCipher Decryption Result: ")
	for i := 0; i < len(decrypted); i++ {
		fmt.Printf("0x%X, ",decrypted[i])
	}


}
